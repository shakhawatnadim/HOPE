using UnityEngine;
using System.Collections;
using System.IO;
using System;

public class Co2Prediction : MonoBehaviour {

	private float rsquared;
	float yintercept;
	float slope;
	int[] month_day={0,31,28,31,30,31,30,31,31,30,31,30,31};

	private static Co2Prediction instance;

	public static Co2Prediction Instance
	{
		get{ 
			return instance;
		}
	}
	/*
		out float rsquared, out float yintercept,
		out float slope*/
	// Use this for initialization
	public void LinearRegression(float[] xVals, float[] yVals,
		int inclusiveStart, int exclusiveEnd)
	{
		Debug.Assert(xVals.Length == yVals.Length);
		float sumOfX = 0;
		float sumOfY = 0;
		float sumOfXSq = 0;
		float sumOfYSq = 0;
		float ssX = 0;
		float ssY = 0;
		float sumCodeviates = 0;
		float sCo = 0;
		float count = exclusiveEnd - inclusiveStart;

		for (int ctr = inclusiveStart; ctr < exclusiveEnd; ctr++)
		{
			float x = xVals[ctr];
			float y = yVals[ctr];
			sumCodeviates += x * y;
			sumOfX += x;
			sumOfY += y;
			sumOfXSq += x * x;
			sumOfYSq += y * y;
		}
		ssX = sumOfXSq - ((sumOfX * sumOfX) / count);
		ssY = sumOfYSq - ((sumOfY * sumOfY) / count);
		float RNumerator = (count * sumCodeviates) - (sumOfX * sumOfY);
		float RDenom = (count * sumOfXSq - (sumOfX * sumOfX))
			* (count * sumOfYSq - (sumOfY * sumOfY));
		sCo = sumCodeviates - ((sumOfX * sumOfY) / count);

		float meanX = sumOfX / count;
		float meanY = sumOfY / count;
		float dblR = RNumerator / Mathf.Sqrt(RDenom);

		rsquared = dblR * dblR;
		yintercept = meanY - ((sCo / ssX) * meanX);
		slope = sCo / ssX;
	}

	void Start () {
		instance = this;
		float[] yVal = new float[1000];
		float[] xVal=new float[1000];
		int i = 0;
		StreamReader sr= new StreamReader("Co2Data.txt");
		while (sr.Peek ()>=0) {
			string line = sr.ReadLine ();
			var parts=line.Split(' ');
			float a = Convert.ToSingle (parts[0]);
			//print (a);
			float b = Convert.ToSingle (parts[1]);
			xVal [i] = a;
			yVal [i] = b;
			print (a+" "+b);
			i++;
		}
		print (i);
		

		/*float[] xVal = 
		{

			1958.208f,1958.292f,1958.375f,1958.458f,1958.542f,1958.625f,1958.708f,1958.792f,1958.875f,1958.958f,1959.042f,1959.125f,1959.208f,1959.292f,1959.375f,1959.458f,1959.542f,1959.625f,1959.708f,1959.792f,1959.875f,1959.958f,1960.042f,1960.125f,1960.208f,1960.292f,1960.375f,1960.458f,1960.542f,1960.625f,1960.708f,1960.792f,1960.875f,1960.958f,1961.042f,1961.125f,1961.208f,1961.292f,1961.375f,1961.458f,1961.542f,1961.625f,1961.708f,1961.792f,1961.875f,1961.958f,1962.042f,1962.125f,1962.208f,1962.292f,1962.375f,1962.458f,1962.542f,1962.625f,1962.708f,1962.792f,1962.875f,1962.958f,1963.042f,1963.125f,1963.208f,1963.292f,1963.375f,1963.458f,1963.542f,1963.625f,1963.708f,1963.792f,1963.875f,1963.958f,1964.042f,1964.125f,1964.208f,1964.292f,1964.375f,1964.458f,1964.542f,1964.625f,1964.708f,1964.792f,1964.875f,1964.958f,1965.042f,1965.125f,1965.208f,1965.292f,1965.375f,1965.458f,1965.542f,1965.625f,1965.708f,1965.792f,1965.875f,1965.958f,1966.042f,1966.125f,1966.208f,1966.292f,1966.375f,1966.458f,1966.542f,1966.625f,1966.708f,1966.792f,1966.875f,1966.958f,1967.042f,1967.125f,1967.208f,1967.292f,1967.375f,1967.458f,1967.542f,1967.625f,1967.708f,1967.792f,1967.875f,1967.958f,1968.042f,1968.125f,1968.208f,1968.292f,1968.375f,1968.458f,1968.542f,1968.625f,1968.708f,1968.792f,1968.875f,1968.958f,1969.042f,1969.125f,1969.208f,1969.292f,1969.375f,1969.458f,1969.542f,1969.625f,1969.708f,1969.792f,1969.875f,1969.958f,1970.042f,1970.125f,1970.208f,1970.292f,1970.375f,1970.458f,1970.542f,1970.625f,1970.708f,1970.792f,1970.875f,1970.958f,1971.042f,1971.125f,1971.208f,1971.292f,1971.375f,1971.458f,1971.542f,1971.625f,1971.708f,1971.792f,1971.875f,1971.958f,1972.042f,1972.125f,1972.208f,1972.292f,1972.375f,1972.458f,1972.542f,1972.625f,1972.708f,1972.792f,1972.875f,1972.958f,1973.042f,1973.125f,1973.208f,1973.292f,1973.375f,1973.458f,1973.542f,1973.625f,1973.708f,1973.792f,1973.875f,1973.958f,1974.042f,1974.125f,1974.208f,1974.292f,1974.375f,1974.458f,1974.542f,1974.625f,1974.708f,1974.792f,1974.875f,1974.958f,1975.042f,1975.125f,1975.208f,1975.292f,1975.375f,1975.458f,1975.542f,1975.625f,1975.708f,1975.792f,1975.875f,1975.958f,1976.042f,1976.125f,1976.208f,1976.292f,1976.375f,1976.458f,1976.542f,1976.625f,1976.708f,1976.792f,1976.875f,1976.958f,1977.042f,1977.125f,1977.208f,1977.292f,1977.375f,1977.458f,1977.542f,1977.625f,1977.708f,1977.792f,1977.875f,1977.958f,1978.042f,1978.125f,1978.208f,1978.292f,1978.375f,1978.458f,1978.542f,1978.625f,1978.708f,1978.792f,1978.875f,1978.958f,1979.042f,1979.125f,1979.208f,1979.292f,1979.375f,1979.458f,1979.542f,1979.625f,1979.708f,1979.792f,1979.875f,1979.958f,1980.042f,1980.125f,1980.208f,1980.292f,1980.375f,1980.458f,1980.542f,1980.625f,1980.708f,1980.792f,1980.875f,1980.958f,1981.042f,1981.125f,1981.208f,1981.292f,1981.375f,1981.458f,1981.542f,1981.625f,1981.708f,1981.792f,1981.875f,1981.958f,1982.042f,1982.125f,1982.208f,1982.292f,1982.375f,1982.458f,1982.542f,1982.625f,1982.708f,1982.792f,1982.875f,1982.958f,1983.042f,1983.125f,1983.208f,1983.292f,1983.375f,1983.458f,1983.542f,1983.625f,1983.708f,1983.792f,1983.875f,1983.958f,1984.042f,1984.125f,1984.208f,1984.292f,1984.375f,1984.458f,1984.542f,1984.625f,1984.708f,1984.792f,1984.875f,1984.958f,1985.042f,1985.125f,1985.208f,1985.292f,1985.375f,1985.458f,1985.542f,1985.625f,1985.708f,1985.792f,1985.875f,1985.958f,1986.042f,1986.125f,1986.208f,1986.292f,1986.375f,1986.458f,1986.542f,1986.625f,1986.708f,1986.792f,1986.875f,1986.958f,1987.042f,1987.125f,1987.208f,1987.292f,1987.375f,1987.458f,1987.542f,1987.625f,1987.708f,1987.792f,1987.875f,1987.958f,1988.042f,1988.125f,1988.208f,1988.292f,1988.375f,1988.458f,1988.542f,1988.625f,1988.708f,1988.792f,1988.875f,1988.958f,1989.042f,1989.125f,1989.208f,1989.292f,1989.375f,1989.458f,1989.542f,1989.625f,1989.708f,1989.792f,1989.875f,1989.958f,1990.042f,1990.125f,1990.208f,1990.292f,1990.375f,1990.458f,1990.542f,1990.625f,1990.708f,1990.792f,1990.875f,1990.958f,1991.042f,1991.125f,1991.208f,1991.292f,1991.375f,1991.458f,1991.542f,1991.625f,1991.708f,1991.792f,1991.875f,1991.958f,1992.042f,1992.125f,1992.208f,1992.292f,1992.375f,1992.458f,1992.542f,1992.625f,1992.708f,1992.792f,1992.875f,1992.958f,1993.042f,1993.125f,1993.208f,1993.292f,1993.375f,1993.458f,1993.542f,1993.625f,1993.708f,1993.792f,1993.875f,1993.958f,1994.042f,1994.125f,1994.208f,1994.292f,1994.375f,1994.458f,1994.542f,1994.625f,1994.708f,1994.792f,1994.875f,1994.958f,1995.042f,1995.125f,1995.208f,1995.292f,1995.375f,1995.458f,1995.542f,1995.625f,1995.708f,1995.792f,1995.875f,1995.958f,1996.042f,1996.125f,1996.208f,1996.292f,1996.375f,1996.458f,1996.542f,1996.625f,1996.708f,1996.792f,1996.875f,1996.958f,1997.042f,1997.125f,1997.208f,1997.292f,1997.375f,1997.458f,1997.542f,1997.625f,1997.708f,1997.792f,1997.875f,1997.958f,1998.042f,1998.125f,1998.208f,1998.292f,1998.375f,1998.458f,1998.542f,1998.625f,1998.708f,1998.792f,1998.875f,1998.958f,1999.042f,1999.125f,1999.208f,1999.292f,1999.375f,1999.458f,1999.542f,1999.625f,1999.708f,1999.792f,1999.875f,1999.958f,2000.042f,2000.125f,2000.208f,2000.292f,2000.375f,2000.458f,2000.542f,2000.625f,2000.708f,2000.792f,2000.875f,2000.958f,2001.042f,2001.125f,2001.208f,2001.292f,2001.375f,2001.458f,2001.542f,2001.625f,2001.708f,2001.792f,2001.875f,2001.958f,2002.042f,2002.125f,2002.208f,2002.292f,2002.375f,2002.458f,2002.542f,2002.625f,2002.708f,2002.792f,2002.875f,2002.958f,2003.042f,2003.125f,2003.208f,2003.292f,2003.375f,2003.458f,2003.542f,2003.625f,2003.708f,2003.792f,2003.875f,2003.958f,2004.042f,2004.125f,2004.208f,2004.292f,2004.375f,2004.458f,2004.542f,2004.625f,2004.708f,2004.792f,2004.875f,2004.958f,2005.042f,2005.125f,2005.208f,2005.292f,2005.375f,2005.458f,2005.542f,2005.625f,2005.708f,2005.792f,2005.875f,2005.958f,2006.042f,2006.125f,2006.208f,2006.292f,2006.375f,2006.458f,2006.542f,2006.625f,2006.708f,2006.792f,2006.875f,2006.958f,2007.042f,2007.125f,2007.208f,2007.292f,2007.375f,2007.458f,2007.542f,2007.625f,2007.708f,2007.792f,2007.875f,2007.958f,2008.042f,2008.125f,2008.208f,2008.292f,2008.375f,2008.458f,2008.542f,2008.625f,2008.708f,2008.792f,2008.875f,2008.958f,2009.042f,2009.125f,2009.208f,2009.292f,2009.375f,2009.458f,2009.542f,2009.625f,2009.708f,2009.792f,2009.875f,2009.958f,2010.042f,2010.125f,2010.208f,2010.292f,2010.375f,2010.458f,2010.542f,2010.625f,2010.708f,2010.792f,2010.875f,2010.958f,2011.042f,2011.125f,2011.208f,2011.292f,2011.375f,2011.458f,2011.542f,2011.625f,2011.708f,2011.792f,2011.875f,2011.958f,2012.042f,2012.125f,2012.208f,2012.292f,2012.375f,2012.458f,2012.542f,2012.625f,2012.708f,2012.792f,2012.875f,2012.958f,2013.042f,2013.125f,2013.208f,2013.292f,2013.375f,2013.458f,2013.542f,2013.625f,2013.708f,2013.792f,2013.875f,2013.958f,2014.042f,2014.125f,2014.208f,2014.292f,2014.375f,2014.458f,2014.542f,2014.625f,2014.708f,2014.792f,2014.875f,2014.958f,2015.042f,2015.125f,2015.208f,2015.292f,2015.375f,2015.458f,2015.542f,2015.625f,2015.708f,2015.792f,2015.875f,2015.958f,2016.042f,2016.125f,2016.208f,2016.292f,2016.375f,2016.458f,2016.542f,2016.625f,2016.708f,2016.792f,2016.875f,2016.958f,2017.042f,2017.125f,2017.208f


			};
		//new double[720]
		float[] yVal =   {
			315.71f,317.45f,317.50f,317.10f,315.86f,314.93f,313.20f,312.66f,313.33f,314.67f,315.62f,316.38f,316.71f,317.72f,318.29f,318.15f,316.54f,314.80f,313.84f,313.26f,314.80f,315.58f,316.43f,316.97f,317.58f,319.02f,320.03f,319.59f,318.18f,315.91f,314.16f,313.83f,315.00f,316.19f,316.93f,317.70f,318.54f,319.48f,320.58f,319.77f,318.57f,316.79f,314.80f,315.38f,316.10f,317.01f,317.94f,318.56f,319.68f,320.63f,321.01f,320.55f,319.58f,317.40f,316.26f,315.42f,316.69f,317.69f,318.74f,319.08f,319.86f,321.39f,322.25f,321.47f,319.74f,317.77f,316.21f,315.99f,317.12f,318.31f,319.57f,320.07f,320.73f,321.77f,322.25f,321.89f,320.44f,318.70f,316.70f,316.79f,317.79f,318.71f,319.44f,320.44f,320.89f,322.13f,322.16f,321.87f,321.39f,318.81f,317.81f,317.30f,318.87f,319.42f,320.62f,321.59f,322.39f,323.87f,324.01f,323.75f,322.39f,320.37f,318.64f,318.10f,319.79f,321.08f,322.07f,322.50f,323.04f,324.42f,325.00f,324.09f,322.55f,320.92f,319.31f,319.31f,320.72f,321.96f,322.57f,323.15f,323.89f,325.02f,325.57f,325.36f,324.14f,322.03f,320.41f,320.25f,321.31f,322.84f,324.00f,324.42f,325.64f,326.66f,327.34f,326.76f,325.88f,323.67f,322.38f,321.78f,322.85f,324.11f,325.03f,325.99f,326.87f,328.13f,328.07f,327.66f,326.35f,324.69f,323.10f,323.16f,323.98f,325.13f,326.17f,326.68f,327.18f,327.78f,328.92f,328.57f,327.34f,325.46f,323.36f,323.57f,324.80f,326.01f,326.77f,327.63f,327.75f,329.72f,330.07f,329.09f,328.05f,326.32f,324.93f,325.06f,326.50f,327.55f,328.54f,329.56f,330.30f,331.50f,332.48f,332.07f,330.87f,329.31f,327.51f,327.18f,328.16f,328.64f,329.35f,330.71f,331.48f,332.65f,333.20f,332.15f,331.07f,329.12f,327.32f,327.28f,328.30f,329.58f,330.73f,331.46f,331.90f,333.17f,333.94f,333.45f,331.98f,329.95f,328.50f,328.35f,329.37f,330.59f,331.59f,332.75f,333.52f,334.64f,334.77f,334.00f,333.06f,330.68f,328.95f,328.75f,330.15f,331.62f,332.66f,333.13f,334.95f,336.13f,336.93f,336.16f,334.88f,332.56f,331.29f,331.27f,332.41f,333.60f,334.95f,335.25f,336.66f,337.69f,338.03f,338.01f,336.41f,334.41f,332.37f,332.41f,333.75f,334.90f,336.14f,336.69f,338.27f,338.96f,339.21f,339.26f,337.54f,335.75f,333.98f,334.19f,335.31f,336.81f,337.90f,338.34f,340.01f,340.93f,341.48f,341.33f,339.40f,337.70f,336.19f,336.15f,337.27f,338.32f,339.29f,340.55f,341.61f,342.54f,343.04f,342.54f,340.78f,338.44f,336.95f,337.08f,338.58f,339.88f,340.96f,341.73f,342.81f,343.97f,344.63f,343.79f,342.32f,340.09f,338.28f,338.29f,339.60f,340.90f,341.68f,342.90f,343.33f,345.25f,346.03f,345.63f,344.19f,342.27f,340.35f,340.38f,341.59f,343.05f,344.10f,344.79f,345.52f,346.84f,347.63f,346.97f,345.53f,343.55f,341.40f,341.67f,343.10f,344.70f,345.21f,346.16f,347.74f,348.33f,349.06f,348.38f,346.71f,345.02f,343.27f,343.13f,344.49f,345.88f,346.56f,347.28f,348.01f,349.77f,350.38f,349.93f,348.16f,346.08f,345.22f,344.51f,345.93f,347.22f,348.52f,348.73f,349.73f,351.31f,352.09f,351.53f,350.11f,348.08f,346.52f,346.59f,347.96f,349.16f,350.39f,351.64f,352.41f,353.69f,354.21f,353.72f,352.69f,350.40f,348.92f,349.13f,350.20f,351.41f,352.91f,353.27f,353.96f,355.64f,355.86f,355.37f,353.99f,351.81f,350.05f,350.25f,351.49f,352.85f,353.80f,355.04f,355.73f,356.32f,357.32f,356.34f,354.84f,353.01f,351.31f,351.62f,353.07f,354.33f,354.84f,355.73f,357.23f,358.66f,359.13f,358.13f,356.19f,353.85f,352.25f,352.35f,353.81f,355.12f,356.25f,357.11f,357.86f,359.09f,359.59f,359.33f,357.01f,354.94f,352.95f,353.32f,354.32f,355.57f,357.00f,357.31f,358.47f,359.27f,360.19f,359.52f,357.33f,355.64f,354.03f,354.12f,355.41f,356.91f,358.24f,358.92f,359.99f,361.23f,361.65f,360.81f,359.38f,357.46f,355.73f,356.07f,357.53f,358.98f,359.92f,360.86f,361.83f,363.30f,363.69f,363.19f,361.64f,359.12f,358.17f,357.99f,359.45f,360.68f,362.07f,363.24f,364.17f,364.57f,365.13f,364.92f,363.55f,361.38f,359.54f,359.58f,360.89f,362.24f,363.09f,364.03f,364.51f,366.35f,366.64f,365.59f,364.31f,362.25f,360.29f,360.82f,362.49f,364.38f,365.26f,365.98f,367.24f,368.66f,369.42f,368.99f,367.82f,365.95f,364.02f,364.40f,365.52f,367.13f,368.18f,369.07f,369.68f,370.99f,370.96f,370.30f,369.45f,366.90f,364.81f,365.37f,366.72f,368.10f,369.29f,369.54f,370.60f,371.81f,371.58f,371.70f,369.86f,368.13f,367.00f,367.03f,368.37f,369.67f,370.59f,371.51f,372.43f,373.37f,373.85f,373.21f,371.51f,369.61f,368.18f,368.45f,369.76f,371.24f,372.53f,373.20f,374.12f,375.02f,375.76f,375.52f,374.01f,371.85f,370.75f,370.55f,372.25f,373.79f,374.88f,375.64f,376.45f,377.73f,378.60f,378.28f,376.70f,374.38f,373.17f,373.14f,374.66f,375.99f,377.00f,377.87f,378.88f,380.35f,380.62f,379.69f,377.47f,376.01f,374.25f,374.46f,376.16f,377.51f,378.46f,379.73f,380.77f,382.29f,382.45f,382.22f,380.74f,378.74f,376.70f,377.00f,378.35f,380.11f,381.38f,382.19f,382.67f,384.61f,385.03f,384.05f,382.46f,380.41f,378.85f,379.13f,380.15f,381.82f,382.89f,383.90f,384.58f,386.50f,386.56f,386.10f,384.50f,381.99f,380.96f,381.12f,382.45f,383.95f,385.52f,385.82f,386.03f,387.21f,388.54f,387.76f,386.36f,384.09f,383.18f,382.99f,384.19f,385.56f,386.94f,387.47f,388.82f,389.55f,390.14f,389.48f,388.03f,386.11f,384.74f,384.43f,386.02f,387.42f,388.71f,390.20f,391.17f,392.46f,393.00f,392.15f,390.20f,388.35f,386.85f,387.24f,388.67f,389.79f,391.33f,391.86f,392.60f,393.25f,394.19f,393.73f,392.51f,390.13f,389.08f,389.00f,390.28f,391.86f,393.12f,393.86f,394.40f,396.18f,396.74f,395.71f,394.36f,392.39f,391.11f,391.05f,392.98f,394.34f,395.55f,396.80f,397.43f,398.41f,399.78f,398.61f,397.32f,395.20f,393.45f,393.70f,395.16f,396.84f,397.85f,398.01f,399.77f,401.38f,401.78f,401.25f,399.10f,397.03f,395.38f,396.03f,397.28f,398.91f,399.98f,400.28f,401.54f,403.28f,403.96f,402.80f,401.31f,398.93f,397.63f,398.29f,400.16f,401.85f,402.52f,404.04f,404.83f,407.42f,407.70f,406.81f,404.39f,402.25f,401.03f,401.57f,403.53f,404.48f,406.13f,406.42f,407.18f

			};*/



		//float yearDecimal;
		/*float year=2017;
		float month=9;
		float day=23;
		int i;
		for(i=0;i<month-1;i++) day+=month_day[i];
		yearDecimal=year+(float)day/365.0f;*/
		LinearRegression(xVal, yVal,0,i);
		//print( yintercept + (slope*yearDecimal));
	
	}
	public float getCo2Prediction(float y,float m, float d){
		float yearDecimal;
		int i;
		for(i=0;i<m-1;i++) d+=month_day[i];
		yearDecimal=y+(float)d/365.0f;
		if (yearDecimal < 1953)
			return 0;
		return yintercept + (slope * yearDecimal);
	}
	
	// Update is called once per frame
	void Update () {
		
	}
}
